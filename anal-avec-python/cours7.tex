\section{Utilisation des formules de quadratiuie. Formule de quadrature élémentaires et composées}
\subsection{Définition}
On appelle formule de quadrature élémentaire $I_e$ sur  $[-1, 1]$ associée aux poits  $\xi_i \in [-1, 1]$ et de poids $\omega_i$,  $i = 1, \ldots, N$, la formule
\[
    I_e(f) = \sum_{i=1}^{N} \omega_if(\xi_i) \quad \text{ pour } f \in \mathcal{C}^0([-1, 1])
\] 
Une subdivision d'un intervalle $[a, b]$ en  $n$ points  $a = x_1 < x_2 < \ldots < x_n = b$ étant donnée, elle induit une formule de quadrature composite $I_c$ pour  $[a, b]$ 
\[
I_c = \sum_{i=1}^{n-1} I_e(f; x_i, x_{i+1}) \equiv \sum_{j=1}^{n-1} \frac{x_{j+1} - x_{j}}{2}\sum_{i=1}^{N} \omega_{i}f(x_{i,j}) \text{ où } x_{i, j} = \frac{(x_j + x_{j+1}) + \xi_{i}(x_{j+1} - x_j))}{2}
\] 

\underline{Illustation:}
\begin{figure}[H]
    \centering
    \incfig{illustration-de-l-integrale}
    \caption{$I_e(f) = \sum_{i=1}^{N} \omega_if(\xi_i) \approx \int_{{\alpha}}^{{\beta}} {f(t)} \: d{t} {}$}
    \label{fig:illustration-de-l-integrale}
\end{figure}
\begin{align*}
    \int_{{\alpha}}^{{\beta}} {f(t)} \: d{t} \approx \frac{s+1}{2}=\frac{t-\alpha}{\beta - \alpha} \implies \eta = \alpha + \frac{s+1}{2}(\beta - \alpha)\\
    dt = \frac{\beta - \alpha}{2} ds
\end{align*}
\begin{align*}
    \int_{{\alpha}}^{{\beta}} {f(t)} \: d{t} = \frac{\beta - \alpha}{2} \int_{{-1}}^{{1}} {f(\alpha + \frac{s+1}{2}(\beta - 1))} \: d{s} &\approx \frac{\beta - \alpha}{2}\sum_{i=1}^{N} \omega_if(\underbrace{ \alpha + \frac{\xi_{i}+1}{2}(\beta - 1) }_{x_i})\\
                                                                                                                                         &\approx \sum_{i=1}^{N} \left( \frac{\beta - \alpha}{2}\omega_i \right) f(x_i)\\
                                                                                                                                         &\approx I_e(f, \alpha, \beta)
\end{align*}
\subsection{Méthode de quadrature clamique}
\subsubsection*{Méthode de rectangles}
\begin{definition}
    \[
    \int_{{\alpha}}^{{\beta}} {f(t)} \: d{t} \approx f(\alpha)(\beta - \alpha)
    \] 
\begin{figure}[H]
    \centering
    \incfig{methode-rectangle}
    \caption{methode-rectangle}
    \label{fig:methode-rectangle}
\end{figure}
\end{definition}
\begin{prop}
    \begin{itemize}
        \item 
            Si $f$ est  $\mathcal{C}^{1}$ sur  $[\alpha, \beta]$ l'erreur de la méthode de quadrature élémentaires :
            \[
                E_e(f) = I(f) - I_e(f) = \frac{f'(c)}{2}(\beta - \alpha )^2 \text{ où } c \in ]\alpha, \beta[
            \] 
        \item Si $f$ est de classe  $\mathcal{C}^1$ sur  $[a, b]$, l'erreur de quadrature de la méthode composite associée à une subdivision uniforme de pas  $h$ est majorée par 
             \[
                 \left| E_c(f) \right| = \left| I(f) - I_c(f) \right| \le h \underbrace{\|f'\|_{\mathcal{C}^0([a, b])}}_{\max_{a \le x \le b}|f'(x)|} \frac{b - a}{2}
            \] 
    \end{itemize}
\end{prop}
\begin{preuve}
    Posons $F(x) = \int_{{a}}^{{x}} {f(t)} \: d{t}$, $F$ est de  $\mathcal{C}^2$ car $f$ est  $\mathcal{C}^1$. Par Taylor lagrange à l'ordre 2 en $\alpha$ donne
     \[
         F(\beta) = F(\alpha) + F'(\alpha)(\beta - \alpha) + F''(c) \frac{(\beta - \alpha)^2}{2} \text{ où } c \in ]\alpha, \beta[
    \] 
    D'où
    \[
        \int_{{\alpha}}^{{\beta}} {f(t)} \: d{t} - f(\alpha)(\beta - \alpha) = \frac{f'(c)}{2}(\beta - \alpha)^2
    \] 
    On en déduit
    \begin{align*}
        \left| I(f) - I_c(f) \right| &= \left| \int_{{a}}^{{b}} {f(t)} \: d{t} - I_c(f) \right| \\
                                     &= \left| \sum_{j=0}^{n-1} \int_{{x_j}}^{{x_{j+1}}} {f(t)} \: d{t} - \sum_{j=0}^{n-1} f(x_j)(x_{j+1} - x_{j}) \right| \\
                                     &\le \sum_{j=0}^{n-1} \left| \int_{{x_j}}^{{x_{j+1}}} {f(t)} \: d{t} - f(x_j)(x_{j+1} - x_{j}) \right| \\
                                     &\le \sum_{j=0}^{n-1} \frac{\|f'\|_{\infty}}{2}(x_{j+1} - x_{j})^2\\
                                     &\le h \frac{\|f'\|_{\infty}}{2}\sum_{j=0}^{n-1} (x_{j+1} - x_{j})\\
                                     &\le h \frac{\|f'\|_{\infty}}{2}(b - a)
    \end{align*}
\end{preuve}

\subsection{Méthode de trapèze}
\begin{definition}
    \[
        \int_{{a}}^{{b}} {f(x)} \: d{x} \approx \frac{f(a)f(b)}{2}(b - a)
    \] 
\begin{figure}[H]
    \centering
    \incfig{methode-de-trapeze}
    \caption{Méthode de trapeze}
    \label{fig:methode-de-trapeze}
\end{figure}
\end{definition}
\begin{prop}
    Si $f$ est  $\mathcal{C}^{?}$ sur  $[a, b]$ 
    \[
        \left| E_c(f) \right| = \left| I(f) - I_c(f) \right| \le \frac{\|f^{1 + 2}}{1 \cdot 2}(b - a)^{12}
    \] 
    \[
        \left| E_c(f) \right| = \left| I(f) - I_c(f) \right| \le h^{2} \|f\|_{\infty}\frac{(b - a)}{12}
    \] 
\end{prop}
\begin{preuve}
   La formule était exacte pour les poly de degré $1$, elle est du type interpolation:
   \[
   I_c(f) = \int_{{a}}^{{b}} {P_f(t)} \: d{t} \text{ où }  P_f \text{ est le poly d'ext aux points } a, b
   \] 
   D'où
   \begin{align*}
       \left| E_c(f) \right| = \left| I(f) - I_c(f) \right| &= \left| \int_{{a}}^{{b}} {(f(t) - P_f(t))} \: d{t} {} \right| \\
                                                            &\le  \frac{\|f''\|_{\infty}}{2!}\int_{{a}}^{{b}} {(x - a)(b - x)} \: d{x} {}
   \end{align*}
   On en déduit que:
   \begin{align*}
       \left| I(f) - I_c(f) \right| &= \left| \sum_{j=0}^{n-1} \left( \int_{{x_j}}^{{x_{j+1}}} {f(t)} \: d{t} \right) - \frac{f(x_j) + f(x_{j+1})}{2}(x_{j+1} - x_{j}) \right| \\
                                    &\le \sum_{j=0}^{n-1} |E_c(f)| \\
                                    &\le \frac{\|f''\|_{\infty}}{12}\sum_{j=0}^{n-1} h^b = \frac{h^2}{12}\|f''\|_{\infty}\sum_{j=0}^{n-1} h\\
                                    &\le \frac{1}{12}h^2 \|f''\|_{\infty}(b - a)
   \end{align*}
\end{preuve}

\subsection{Méthode de point-milieu}
\begin{definition}
    \[
    \int_{{\alpha}}^{{\beta}} {f(t)} \: d{t} \approx f(\frac{\alpha + \beta}{2})(\beta - \alpha)
    \] 
\begin{figure}[H]
    \centering
    \incfig{methode-de-point-milieu}
    \caption{methode-de-point-milieu}
    \label{fig:methode-de-point-milieu}
\end{figure}
\end{definition}
\begin{eg} degré d'exactitude sur $[-1, 1]$ elle devient
     \[
    \int_{{-1}}^{{1}} {f(s)} \: d{s} \approx 2f(0)
    \] 
    \begin{itemize}
        \item Pour $f = 1$, on a  $I(f) = \int_{{-1}}^{{1}} {} \: d{s} 2 = 2 \cdot 1 = I_c(f)$. D'où $I_c$ est excte pour poly de degré \underline{au moins 0}.
        \item Pour  $f = s$ on a  $I(f) = \int_{{-1}}^{{1}} {s} \: d{s} = 0 = 2 \cdot 0 = I_c(f)$. D'où $I_c$ est exacte pour poly de degré \underline{au moins 1}.
        \item  Pour  $f = s^2$ on a  $I(f) = \int_{{-1}}^{{1}} {s^2} \: d{s} = \frac{2}{3} \neq  2 \cdot 0^2 = I_c(f)$. La formule élémentaire n'est pas exacte pour poly de degré 2. Donc, la formule de point-milieuest exacte pour les polynômes de degré $1$.
    \end{itemize}
\end{eg}
\begin{prop}
    \begin{itemize}
        \item Si $f$ est  $\mathcal{C}^2([a, b])$ on a:
             \[
            E_c(f) = I(f) - I_c(f) = \frac{f''(c)}{24}(b - a)^3
            \] 
        \item Si $f$ est  $\mathcal{C}^2$ sur  $[a, b]$, l'erreur de quadrature de la méthode composite associée à une subdivision uniforme de  $[a, b]$ de pas  $h$ est majorée par
             \[
            \left| E_c(f) \right| = \left| I(f) - I_c(f) \right| \le h^2 \frac{\|f''\|_{\infty}}{24}(b - a)
            \] 
    \end{itemize}
\end{prop}
\begin{preuve}
   exo 
\end{preuve}

\subsection{Méthode de Simpson}
\begin{definition}
    \[
    \int_{{\alpha}}^{{\beta}} {f(t)} \: d{t} \approx \frac{\beta - \alpha}{6}\left( f(\alpha) + 4f(\frac{\alpha + \beta}{2}) + f(\beta) \right) 
    \] 
\begin{figure}[H]
    \centering
    \incfig{methode-de-simpson}
    \caption{methode-de-simpson}
    \label{fig:methode-de-simpson}
\end{figure}
\end{definition}
\begin{prop}
    \begin{itemize}
        \item Si $f$ est  $\mathcal{C}^{3 + 1}$ sur  $[\alpha, \beta]$ on a:
             \[
                 E_c(f) = \int_{{\alpha}}^{{\beta}} {f(x)} \: d{x} - I_e(f) = -\frac{f^{(4)}}{2880}(\beta - \alpha)^5 \text{ où } c \in ]\alpha, \beta[
            \] 
            \[
                \left| E_c(f) \right| \le h^{4} \|f^{(4)}\|_{\infty} \frac{(b-a)}{2880}
            \] 
    \end{itemize}
\end{prop}
